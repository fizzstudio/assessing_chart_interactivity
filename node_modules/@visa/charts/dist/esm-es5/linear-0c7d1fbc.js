import{b as bisectRight}from"./max-d011e4a4.js";import{i as interpolateNumber}from"./index-863acfec.js";import{i as interpolate}from"./value-39eebe2d.js";var e10=Math.sqrt(50),e5=Math.sqrt(10),e2=Math.sqrt(2);function ticks(n,e,t){var r,i=-1,a,o,u;e=+e,n=+n,t=+t;if(n===e&&t>0)return[n];if(r=e<n)a=n,n=e,e=a;if((u=tickIncrement(n,e,t))===0||!isFinite(u))return[];if(u>0){n=Math.ceil(n/u);e=Math.floor(e/u);o=new Array(a=Math.ceil(e-n+1));while(++i<a)o[i]=(n+i)*u}else{n=Math.floor(n*u);e=Math.ceil(e*u);o=new Array(a=Math.ceil(n-e+1));while(++i<a)o[i]=(n-i)/u}if(r)o.reverse();return o}function tickIncrement(n,e,t){var r=(e-n)/Math.max(0,t),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=e10?10:a>=e5?5:a>=e2?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=e10?10:a>=e5?5:a>=e2?2:1)}function tickStep(n,e,t){var r=Math.abs(e-n)/Math.max(0,t),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;if(a>=e10)i*=10;else if(a>=e5)i*=5;else if(a>=e2)i*=2;return e<n?-i:i}function interpolateRound(n,e){return n=+n,e=+e,function(t){return Math.round(n*(1-t)+e*t)}}function initRange(n,e){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(e).domain(n);break}return this}var prefix="$";function Map(){}Map.prototype=map$2.prototype={constructor:Map,has:function(n){return prefix+n in this},get:function(n){return this[prefix+n]},set:function(n,e){this[prefix+n]=e;return this},remove:function(n){var e=prefix+n;return e in this&&delete this[e]},clear:function(){for(var n in this)if(n[0]===prefix)delete this[n]},keys:function(){var n=[];for(var e in this)if(e[0]===prefix)n.push(e.slice(1));return n},values:function(){var n=[];for(var e in this)if(e[0]===prefix)n.push(this[e]);return n},entries:function(){var n=[];for(var e in this)if(e[0]===prefix)n.push({key:e.slice(1),value:this[e]});return n},size:function(){var n=0;for(var e in this)if(e[0]===prefix)++n;return n},empty:function(){for(var n in this)if(n[0]===prefix)return false;return true},each:function(n){for(var e in this)if(e[0]===prefix)n(this[e],e.slice(1),this)}};function map$2(n,e){var t=new Map;if(n instanceof Map)n.each((function(n,e){t.set(e,n)}));else if(Array.isArray(n)){var r=-1,i=n.length,a;if(e==null)while(++r<i)t.set(r,n[r]);else while(++r<i)t.set(e(a=n[r],r,n),a)}else if(n)for(var o in n)t.set(o,n[o]);return t}function nest(){var n=[],e=[],t,r,i;function a(e,i,o,u){if(i>=n.length){if(t!=null)e.sort(t);return r!=null?r(e):e}var f=-1,c=e.length,s=n[i++],l,h,p=map$2(),m,d=o();while(++f<c){if(m=p.get(l=s(h=e[f])+"")){m.push(h)}else{p.set(l,[h])}}p.each((function(n,e){u(d,e,a(n,i,o,u))}));return d}function o(t,i){if(++i>n.length)return t;var a,u=e[i-1];if(r!=null&&i>=n.length)a=t.entries();else a=[],t.each((function(n,e){a.push({key:e,values:o(n,i)})}));return u!=null?a.sort((function(n,e){return u(n.key,e.key)})):a}return i={object:function(n){return a(n,0,createObject,setObject)},map:function(n){return a(n,0,createMap,setMap)},entries:function(n){return o(a(n,0,createMap,setMap),0)},key:function(e){n.push(e);return i},sortKeys:function(t){e[n.length-1]=t;return i},sortValues:function(n){t=n;return i},rollup:function(n){r=n;return i}}}function createObject(){return{}}function setObject(n,e,t){n[e]=t}function createMap(){return map$2()}function setMap(n,e,t){n.set(e,t)}var array=Array.prototype;var map$1=array.map;var slice=array.slice;var implicit={name:"implicit"};function ordinal(){var n=map$2(),e=[],t=[],r=implicit;function i(i){var a=i+"",o=n.get(a);if(!o){if(r!==implicit)return r;n.set(a,o=e.push(i))}return t[(o-1)%t.length]}i.domain=function(t){if(!arguments.length)return e.slice();e=[],n=map$2();var r=-1,a=t.length,o,u;while(++r<a)if(!n.has(u=(o=t[r])+""))n.set(u,e.push(o));return i};i.range=function(n){return arguments.length?(t=slice.call(n),i):t.slice()};i.unknown=function(n){return arguments.length?(r=n,i):r};i.copy=function(){return ordinal(e,t).unknown(r)};initRange.apply(i,arguments);return i}function constant(n){return function(){return n}}function number(n){return+n}var unit=[0,1];function identity$1(n){return n}function normalize(n,e){return(e-=n=+n)?function(t){return(t-n)/e}:constant(isNaN(e)?NaN:.5)}function clamper(n){var e=n[0],t=n[n.length-1],r;if(e>t)r=e,e=t,t=r;return function(n){return Math.max(e,Math.min(t,n))}}function bimap(n,e,t){var r=n[0],i=n[1],a=e[0],o=e[1];if(i<r)r=normalize(i,r),a=t(o,a);else r=normalize(r,i),a=t(a,o);return function(n){return a(r(n))}}function polymap(n,e,t){var r=Math.min(n.length,e.length)-1,i=new Array(r),a=new Array(r),o=-1;if(n[r]<n[0]){n=n.slice().reverse();e=e.slice().reverse()}while(++o<r){i[o]=normalize(n[o],n[o+1]);a[o]=t(e[o],e[o+1])}return function(e){var t=bisectRight(n,e,1,r)-1;return a[t](i[t](e))}}function copy(n,e){return e.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}function transformer(){var n=unit,e=unit,t=interpolate,r,i,a,o=identity$1,u,f,c;function s(){u=Math.min(n.length,e.length)>2?polymap:bimap;f=c=null;return l}function l(i){return isNaN(i=+i)?a:(f||(f=u(n.map(r),e,t)))(r(o(i)))}l.invert=function(t){return o(i((c||(c=u(e,n.map(r),interpolateNumber)))(t)))};l.domain=function(e){return arguments.length?(n=map$1.call(e,number),o===identity$1||(o=clamper(n)),s()):n.slice()};l.range=function(n){return arguments.length?(e=slice.call(n),s()):e.slice()};l.rangeRound=function(n){return e=slice.call(n),t=interpolateRound,s()};l.clamp=function(e){return arguments.length?(o=e?clamper(n):identity$1,l):o!==identity$1};l.interpolate=function(n){return arguments.length?(t=n,s()):t};l.unknown=function(n){return arguments.length?(a=n,l):a};return function(n,e){r=n,i=e;return s()}}function continuous(n,e){return transformer()(n,e)}function formatDecimal(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)}function formatDecimalParts(n,e){if((t=(n=e?n.toExponential(e-1):n.toExponential()).indexOf("e"))<0)return null;var t,r=n.slice(0,t);return[r.length>1?r[0]+r.slice(2):r,+n.slice(t+1)]}function exponent(n){return n=formatDecimalParts(Math.abs(n)),n?n[1]:NaN}function formatGroup(n,e){return function(t,r){var i=t.length,a=[],o=0,u=n[0],f=0;while(i>0&&u>0){if(f+u+1>r)u=Math.max(1,r-f);a.push(t.substring(i-=u,i+u));if((f+=u+1)>r)break;u=n[o=(o+1)%n.length]}return a.reverse().join(e)}}function formatNumerals(n){return function(e){return e.replace(/[0-9]/g,(function(e){return n[+e]}))}}var re=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function formatSpecifier(n){if(!(e=re.exec(n)))throw new Error("invalid format: "+n);var e;return new FormatSpecifier({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}formatSpecifier.prototype=FormatSpecifier.prototype;function FormatSpecifier(n){this.fill=n.fill===undefined?" ":n.fill+"";this.align=n.align===undefined?">":n.align+"";this.sign=n.sign===undefined?"-":n.sign+"";this.symbol=n.symbol===undefined?"":n.symbol+"";this.zero=!!n.zero;this.width=n.width===undefined?undefined:+n.width;this.comma=!!n.comma;this.precision=n.precision===undefined?undefined:+n.precision;this.trim=!!n.trim;this.type=n.type===undefined?"":n.type+""}FormatSpecifier.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===undefined?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===undefined?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function formatTrim(n){n:for(var e=n.length,t=1,r=-1,i;t<e;++t){switch(n[t]){case".":r=i=t;break;case"0":if(r===0)r=t;i=t;break;default:if(!+n[t])break n;if(r>0)r=0;break}}return r>0?n.slice(0,r)+n.slice(i+1):n}var prefixExponent;function formatPrefixAuto(n,e){var t=formatDecimalParts(n,e);if(!t)return n+"";var r=t[0],i=t[1],a=i-(prefixExponent=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+formatDecimalParts(n,Math.max(0,e+a-1))[0]}function formatRounded(n,e){var t=formatDecimalParts(n,e);if(!t)return n+"";var r=t[0],i=t[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var formatTypes={"%":function(n,e){return(n*100).toFixed(e)},b:function(n){return Math.round(n).toString(2)},c:function(n){return n+""},d:formatDecimal,e:function(n,e){return n.toExponential(e)},f:function(n,e){return n.toFixed(e)},g:function(n,e){return n.toPrecision(e)},o:function(n){return Math.round(n).toString(8)},p:function(n,e){return formatRounded(n*100,e)},r:formatRounded,s:formatPrefixAuto,X:function(n){return Math.round(n).toString(16).toUpperCase()},x:function(n){return Math.round(n).toString(16)}};function identity(n){return n}var map=Array.prototype.map,prefixes=["y","z","a","f","p","n","Âµ","m","","k","M","G","T","P","E","Z","Y"];function formatLocale(n){var e=n.grouping===undefined||n.thousands===undefined?identity:formatGroup(map.call(n.grouping,Number),n.thousands+""),t=n.currency===undefined?"":n.currency[0]+"",r=n.currency===undefined?"":n.currency[1]+"",i=n.decimal===undefined?".":n.decimal+"",a=n.numerals===undefined?identity:formatNumerals(map.call(n.numerals,String)),o=n.percent===undefined?"%":n.percent+"",u=n.minus===undefined?"-":n.minus+"",f=n.nan===undefined?"NaN":n.nan+"";function c(n){n=formatSpecifier(n);var c=n.fill,s=n.align,l=n.sign,h=n.symbol,p=n.zero,m=n.width,d=n.comma,g=n.precision,M=n.trim,y=n.type;if(y==="n")d=true,y="g";else if(!formatTypes[y])g===undefined&&(g=12),M=true,y="g";if(p||c==="0"&&s==="=")p=true,c="0",s="=";var v=h==="$"?t:h==="#"&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x=h==="$"?r:/[%p]/.test(y)?o:"";var b=formatTypes[y],w=/[defgprs%]/.test(y);g=g===undefined?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g));function k(n){var t=v,r=x,o,h,k;if(y==="c"){r=b(n)+r;n=""}else{n=+n;var N=n<0||1/n<0;n=isNaN(n)?f:b(Math.abs(n),g);if(M)n=formatTrim(n);if(N&&+n===0&&l!=="+")N=false;t=(N?l==="("?l:u:l==="-"||l==="("?"":l)+t;r=(y==="s"?prefixes[8+prefixExponent/3]:"")+r+(N&&l==="("?")":"");if(w){o=-1,h=n.length;while(++o<h){if(k=n.charCodeAt(o),48>k||k>57){r=(k===46?i+n.slice(o+1):n.slice(o))+r;n=n.slice(0,o);break}}}}if(d&&!p)n=e(n,Infinity);var $=t.length+n.length+r.length,S=$<m?new Array(m-$+1).join(c):"";if(d&&p)n=e(S+n,S.length?m-r.length:Infinity),S="";switch(s){case"<":n=t+n+r+S;break;case"=":n=t+S+n+r;break;case"^":n=S.slice(0,$=S.length>>1)+t+n+r+S.slice($);break;default:n=S+t+n+r;break}return a(n)}k.toString=function(){return n+""};return k}function s(n,e){var t=c((n=formatSpecifier(n),n.type="f",n)),r=Math.max(-8,Math.min(8,Math.floor(exponent(e)/3)))*3,i=Math.pow(10,-r),a=prefixes[8+r/3];return function(n){return t(i*n)+a}}return{format:c,formatPrefix:s}}var locale;var format;var formatPrefix;defaultLocale({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function defaultLocale(n){locale=formatLocale(n);format=locale.format;formatPrefix=locale.formatPrefix;return locale}function precisionFixed(n){return Math.max(0,-exponent(Math.abs(n)))}function precisionPrefix(n,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(exponent(e)/3)))*3-exponent(Math.abs(n)))}function precisionRound(n,e){n=Math.abs(n),e=Math.abs(e)-n;return Math.max(0,exponent(e)-exponent(n))+1}function tickFormat(n,e,t,r){var i=tickStep(n,e,t),a;r=formatSpecifier(r==null?",f":r);switch(r.type){case"s":{var o=Math.max(Math.abs(n),Math.abs(e));if(r.precision==null&&!isNaN(a=precisionPrefix(i,o)))r.precision=a;return formatPrefix(r,o)}case"":case"e":case"g":case"p":case"r":{if(r.precision==null&&!isNaN(a=precisionRound(i,Math.max(Math.abs(n),Math.abs(e)))))r.precision=a-(r.type==="e");break}case"f":case"%":{if(r.precision==null&&!isNaN(a=precisionFixed(i)))r.precision=a-(r.type==="%")*2;break}}return format(r)}function linearish(n){var e=n.domain;n.ticks=function(n){var t=e();return ticks(t[0],t[t.length-1],n==null?10:n)};n.tickFormat=function(n,t){var r=e();return tickFormat(r[0],r[r.length-1],n==null?10:n,t)};n.nice=function(t){if(t==null)t=10;var r=e(),i=0,a=r.length-1,o=r[i],u=r[a],f;if(u<o){f=o,o=u,u=f;f=i,i=a,a=f}f=tickIncrement(o,u,t);if(f>0){o=Math.floor(o/f)*f;u=Math.ceil(u/f)*f;f=tickIncrement(o,u,t)}else if(f<0){o=Math.ceil(o*f)/f;u=Math.floor(u*f)/f;f=tickIncrement(o,u,t)}if(f>0){r[i]=Math.floor(o/f)*f;r[a]=Math.ceil(u/f)*f;e(r)}else if(f<0){r[i]=Math.ceil(o*f)/f;r[a]=Math.floor(u*f)/f;e(r)}return n};return n}function linear(){var n=continuous(identity$1,identity$1);n.copy=function(){return copy(n,linear())};initRange.apply(n,arguments);return linearish(n)}export{identity$1 as a,copy as b,continuous as c,linearish as d,transformer as e,initRange as i,linear as l,map$1 as m,nest as n,ordinal as o,slice as s,tickStep as t};